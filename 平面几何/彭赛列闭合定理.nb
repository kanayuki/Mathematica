(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13794,        378]
NotebookOptionsPosition[     12850,        352]
NotebookOutlinePosition[     13265,        369]
CellTagsIndexPosition[     13222,        366]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:5f6d\:8d5b\:5217\:95ed\:5408\:5b9a\:7406", "Title",
 CellChangeTimes->{3.881082716044603*^9, 
  3.881082764491373*^9},ExpressionUUID->"e7d1b762-ff42-4fdd-a601-\
0d86efacddd7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], ",", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], ";", 
    RowBox[{"pa", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "t1", "]"}]}], ",", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", "t1", "]"}]}]}], "}"}]}], ";", 
    RowBox[{"pb", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "t2", "]"}]}], ",", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", "t2", "]"}]}]}], "}"}]}], ";", 
    RowBox[{"pc", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "t3", "]"}]}], ",", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", "t3", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SolveValues", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "pa"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"p", "-", "pb"}], ")"}]}], 
       RowBox[{"Norm", "[", 
        RowBox[{"p", "-", "pa"}], "]"}]], "==", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "pa"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"p", "-", "pc"}], ")"}]}], 
       RowBox[{"Norm", "[", 
        RowBox[{"p", "-", "pa"}], "]"}]]}], ",", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8810557589004526`*^9, 3.8810557654388885`*^9}, {
   3.881083089603348*^9, 3.8810830929271593`*^9}, {3.8810831267903047`*^9, 
   3.8810831775557547`*^9}, {3.8810832460113325`*^9, 
   3.8810833205747194`*^9}, {3.8810833554709387`*^9, 
   3.8810833681177526`*^9}, {3.8810834276590805`*^9, 
   3.8810834614031706`*^9}, {3.8810835618336067`*^9, 3.8810835653349705`*^9}, 
   3.8810836013513885`*^9, {3.88108372821583*^9, 3.8810837298386965`*^9}, {
   3.881083877479788*^9, 3.881083892002659*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"b328717c-dc28-4bde-bd28-9af7c450bd67"],

Cell[BoxData[
 TemplateBox[{
  "SolveValues", "ifun", 
   "\"\\!\\(\\*RowBox[{\\\"SolveValues\\\"}]\\) \
\:6b63\:5728\:4f7f\:7528\:53cd\:51fd\:6570\:ff0c\:56e0\:6b64\:53ef\:80fd\:65e0\
\:6cd5\:627e\:5230\:67d0\:4e9b\:89e3\:ff1b\:8bf7\:4f7f\:7528 Reduce \:6765\
\:83b7\:53d6\:5b8c\:6574\:7684\:89e3\:4fe1\:606f.\"", 2, 12, 5, 
   17826823300239639973, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8810834632279916`*^9, 3.8810835127254996`*^9, 
  3.881083569450584*^9, 3.881083602816445*^9, 3.881083731934757*^9, 
  3.881083901264142*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[11]:=",ExpressionUUID->"a1dca3e9-9a21-4890-8b6b-\
63f4e5d80392"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"ArcCos", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["a", "4"], " ", 
         RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "4"], " ", 
         RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "4"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "4"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "4"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "4"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "4"]}], "-", 
          SuperscriptBox["b", "4"], "+", 
          RowBox[{
           SuperscriptBox["a", "4"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"t2", "+", "t3"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "4"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"t2", "+", "t3"}], "]"}]}]}], ")"}]}], ")"}]}], "]"}]}], 
   ",", 
   RowBox[{"ArcCos", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "4"], " ", 
        RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "4"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "-", "t2", "-", "t3"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "4"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"t1", "+", "t2", "+", "t3"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "4"]}], "-", 
         SuperscriptBox["b", "4"], "+", 
         RowBox[{
          SuperscriptBox["a", "4"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"t2", "+", "t3"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["b", "4"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"t2", "+", "t3"}], "]"}]}]}], ")"}]}], ")"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8810833238892903`*^9, 3.881083374860501*^9, 
  3.8810834633460245`*^9, 3.881083512781507*^9, 3.881083569491474*^9, 
  3.8810836028548384`*^9, 3.881083731970662*^9, 3.881083901303033*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"0e259d39-0fde-4052-afd7-dd2726dd4078"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "a", ",", "b", ",", "pa", ",", "pb", ",", "p1", ",", "p2", ",", 
     "ellipse"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ellipse", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"Cos", "[", "#", "]"}]}], ",", 
        RowBox[{"b", " ", 
         RowBox[{"Sin", "[", "#", "]"}]}]}], "}"}], "&"}]}], ";", 
    RowBox[{"p", "=", 
     RowBox[{"ellipse", "[", "t", "]"}]}], ";", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pa", ",", "pb"}], "}"}], "=", 
     RowBox[{"ellipse", "/@", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", "2"}], 
       "]"}]}]}], ";", 
    RowBox[{"LocatorPane", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", 
       RowBox[{"{", 
        RowBox[{"pa", ",", "pb"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2"}], "}"}], "=", 
         RowBox[{"ellipse", "/@", 
          RowBox[{"SolveValues", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "-", "pa"}], ")"}], ".", 
               RowBox[{"(", 
                RowBox[{"p", "-", "pb"}], ")"}]}], 
              RowBox[{"Abs", "[", 
               RowBox[{"p", "-", "pa"}], "]"}]], "==", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "-", "pa"}], ")"}], ".", 
               RowBox[{"(", 
                RowBox[{"p", "-", "pc"}], ")"}]}], 
              RowBox[{"Abs", "[", 
               RowBox[{"p", "-", "pa"}], "]"}]]}], ",", "t"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "Magenta", ",", 
            RowBox[{"PointSize", "[", "Large", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"pa", ",", "pb", ",", "p1", ",", "p2"}], "}"}], "]"}]}],
            "}"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"Axes", "->", "True"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.881051973217597*^9, 3.8810519802445726`*^9}, {
   3.8810545310620685`*^9, 3.8810545451905036`*^9}, {3.881054599417987*^9, 
   3.8810546995750895`*^9}, {3.8810547313967113`*^9, 
   3.8810549008571663`*^9}, {3.8810550422877874`*^9, 
   3.8810551179454966`*^9}, {3.88105515964493*^9, 3.8810552355145445`*^9}, {
   3.881055281690757*^9, 3.8810553369270444`*^9}, {3.8810553876509237`*^9, 
   3.881055473053095*^9}, {3.881055511818892*^9, 3.8810555224443607`*^9}, {
   3.8810555781428585`*^9, 3.8810556072556305`*^9}, {3.8810557505885887`*^9, 
   3.881055756956994*^9}, {3.881083643673279*^9, 3.881083656567032*^9}, 
   3.881083705431481*^9, {3.8810837520932393`*^9, 3.8810837600348096`*^9}, {
   3.881083799079522*^9, 3.8810838064934645`*^9}, 
   3.8810839144620047`*^9},ExpressionUUID->"a09549b0-536e-4eac-98a6-\
2425c733c9ed"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`a$$ = 3, $CellContext`b$$ = 
  2, $CellContext`pa$$ = {
  2.103996310351758, -1.4256693595214518`}, $CellContext`pb$$ = \
{-2.9462728243106997`, -0.3768149824387751}, $CellContext`p1$$, \
$CellContext`p2$$, $CellContext`ellipse$$ = {$CellContext`a$$ 
   Cos[#], $CellContext`b$$ Sin[#]}& }, 
  LocatorPaneBox[Dynamic[{$CellContext`pa$$, $CellContext`pb$$}], 
   DynamicBox[
    ToBoxes[{$CellContext`p1$$, $CellContext`p2$$} = 
      Map[$CellContext`ellipse$$, 
        SolveValues[
        Dot[$CellContext`p - $CellContext`pa$$, $CellContext`p - \
$CellContext`pb$$]/Abs[$CellContext`p - $CellContext`pa$$] == 
         Dot[$CellContext`p - $CellContext`pa$$, $CellContext`p - \
$CellContext`pc]/Abs[$CellContext`p - $CellContext`pa$$], $CellContext`t]]; 
     Graphics[{
        Circle[{0, 0}, {$CellContext`a$$, $CellContext`b$$}], Magenta, 
        PointSize[Large], 
        Point[{$CellContext`pa$$, $CellContext`pb$$, $CellContext`p1$$, \
$CellContext`p2$$}]}, ImageSize -> Medium, Axes -> True], StandardForm],
    ImageSizeCache->{57.17968940734863, {2., 10.}}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.8810547020435996`*^9, 3.881054909506223*^9, 3.881055374019921*^9, 
   3.8810554132544236`*^9, {3.8810838123642273`*^9, 3.8810838402883854`*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"bfa00c57-a3dd-4462-a1e4-82af3e9a2a79"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{729, 618},
WindowMargins->{{Automatic, 309}, {8.25, Automatic}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (2022\:5e746\:670816\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fbc9e15a-93a1-45b4-a2d9-ae1eccb4ab7d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 183, 3, 98, "Title",ExpressionUUID->"e7d1b762-ff42-4fdd-a601-0d86efacddd7"],
Cell[CellGroupData[{
Cell[788, 29, 2150, 60, 224, "Input",ExpressionUUID->"b328717c-dc28-4bde-bd28-9af7c450bd67"],
Cell[2941, 91, 671, 14, 28, "Message",ExpressionUUID->"a1dca3e9-9a21-4890-8b6b-63f4e5d80392"],
Cell[3615, 107, 4066, 113, 138, "Output",ExpressionUUID->"0e259d39-0fde-4052-afd7-dd2726dd4078"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7718, 225, 3694, 95, 386, "Input",ExpressionUUID->"a09549b0-536e-4eac-98a6-2425c733c9ed"],
Cell[11415, 322, 1407, 26, 41, "Output",ExpressionUUID->"bfa00c57-a3dd-4462-a1e4-82af3e9a2a79"]
}, Open  ]]
}, Open  ]]
}
]
*)

