(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61113,       1701]
NotebookOptionsPosition[     56602,       1610]
NotebookOutlinePosition[     57024,       1627]
CellTagsIndexPosition[     56981,       1624]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:5229\:7528\:77e9\:9635\:8ba1\:7b97\:70b9\:5173\:4e8e\:76f4\:7ebf\:7684\
\:5bf9\:79f0\:70b9", "Title",
 CellChangeTimes->{{3.8631800250138183`*^9, 
  3.863180058259698*^9}},ExpressionUUID->"85787228-ba18-4809-89b6-\
1537c128d482"],

Cell["\:76f4\:7ebfl\:7531a\:ff0cb\:4e24\:70b9\:786e\:5b9a\:ff0c\:6c42\:70b9p\
\:5173\:4e8el\:7684\:5bf9\:79f0\:70b9ps", "Text",
 CellChangeTimes->{{3.86318021422496*^9, 
  3.8631802768391314`*^9}},ExpressionUUID->"81533e1f-1d57-4766-af9a-\
44e52ca3e7ea"],

Cell[CellGroupData[{

Cell["\<\
\:65b9\:5f0f\:4e00\:ff1a\:5229\:7528\:76f8\:4f3c\:53d8\:6362\:ff0c\:6c42\:5bf9\
\:79f0\:53d8\:6362\:77e9\:9635
https://www.bilibili.com/video/BV1zu411673J\
\>", "Subsection",
 CellChangeTimes->{{3.8631801132962008`*^9, 3.863180152158701*^9}, {
  3.863180534214861*^9, 3.863180558072482*^9}, {3.8631872640011473`*^9, 
  3.8631872725024962`*^9}},ExpressionUUID->"fa9da9e5-62c8-4133-a9e7-\
d3530ad9293d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"base", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "-", "b"}], ",", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"a", "-", "b"}], "]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", 
     RowBox[{"Inverse", "[", "m", "]"}]}], "/.", 
    RowBox[{"m", "->", 
     RowBox[{"Transpose", "[", 
      RowBox[{"base", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}], "\n", 
  RowBox[{"(*", "\:53ef\:89c6\:5316", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"visual", "[", "ps_", "]"}], ":=", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Orange", ",", 
        RowBox[{"InfiniteLine", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", 
        RowBox[{"PointSize", "[", "Large", "]"}], ",", "Magenta", ",", 
        RowBox[{"Point", "[", "p", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"ps", "[", 
          RowBox[{"a", ",", "b", ",", "p"}], "]"}], "]"}], ",", "Green", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"(*", 
              RowBox[{"2", 
               RowBox[{"Normalize", "@"}]}], "*)"}], "#"}], "}"}], "&"}], "/@", 
          RowBox[{"base", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "5"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "Locator"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Locator"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "Locator"}], "}"}]}], 
   "]"}]}], "\n", 
 RowBox[{"visual", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"m1", "[", 
     RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "&"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8631801697633295`*^9, 3.8631801840326395`*^9}, {
   3.863180297607416*^9, 3.8631803317960606`*^9}, {3.8631803653331423`*^9, 
   3.863180446193495*^9}, {3.8631806824775295`*^9, 3.863180689721613*^9}, {
   3.863180766160979*^9, 3.8631807941263523`*^9}, {3.8631809190899553`*^9, 
   3.8631809964200706`*^9}, {3.8631811283087745`*^9, 
   3.8631811677104683`*^9}, {3.863181625671811*^9, 3.863181630856614*^9}, {
   3.8631816816930857`*^9, 3.86318172597116*^9}, {3.8631817941012135`*^9, 
   3.8631818300837*^9}, {3.86318248083749*^9, 3.863182579780194*^9}, {
   3.8631826894918385`*^9, 3.8631827040560694`*^9}, {3.863184446785229*^9, 
   3.863184469976922*^9}, {3.8631845766605754`*^9, 3.8631846037671385`*^9}, {
   3.8631846568085384`*^9, 3.8631846739602213`*^9}, {3.863184708534299*^9, 
   3.8631847250107217`*^9}, {3.863184769340135*^9, 3.8631847717262506`*^9}, {
   3.863187372805826*^9, 3.8631873960911627`*^9}, {3.8631875361361775`*^9, 
   3.8631875852736225`*^9}, {3.8631876447905703`*^9, 3.863187688184812*^9}, {
   3.863187722006727*^9, 3.8631877296665964`*^9}, {3.863187763440585*^9, 
   3.8631877912938857`*^9}, {3.8631878243890505`*^9, 3.863187830415188*^9}, 
   3.8631879286745005`*^9, {3.8631879817108865`*^9, 3.863188028340062*^9}, {
   3.86318811988647*^9, 3.8631881557095227`*^9}, 3.8631882108487215`*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"ed57bc89-60e9-4ec5-abe1-d5884267ec20"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
    1}, $CellContext`p$$ = {0, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          (Dot[
           $CellContext`m1[#, #2], #3]& )[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8631883749549904`*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"8551480b-183c-4f32-bb95-228083e94df9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:65b9\:5f0f\:4e8c\:ff1a\:5229\:7528\:8f90\:89d2
https://www.zhihu.com/question/63108236\
\>", "Subsection",
 CellChangeTimes->{{3.863182238119842*^9, 3.863182251804718*^9}, 
   3.86318233353069*^9, 3.8631882876390996`*^9, {3.863188322779394*^9, 
   3.8631883377368183`*^9}},ExpressionUUID->"412f91e9-d930-47bf-bb92-\
9decc7222254"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m2", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Theta]"}], "]"}], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Theta]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Theta]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "\[Theta]"}], "]"}]}]}], "}"}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", "->", 
     RowBox[{"Arg", "[", 
      RowBox[{"Complex", "@@", 
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}]}], "]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"visual", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"m2", "[", 
     RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "&"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8631708933858633`*^9, 3.863170927747899*^9}, {
  3.863178319657544*^9, 3.863178488288752*^9}, {3.8631785354850073`*^9, 
  3.8631785765485344`*^9}, {3.863178606936124*^9, 3.8631786724014683`*^9}, {
  3.8631787447650394`*^9, 3.863178760946077*^9}, {3.8631788393697777`*^9, 
  3.863178893239338*^9}, {3.8631789529864855`*^9, 3.863178957215971*^9}, {
  3.8631799175372453`*^9, 3.863179944159625*^9}, {3.863182019211675*^9, 
  3.8631820937478185`*^9}, {3.8631821327722473`*^9, 3.8631821776937833`*^9}, {
  3.8631848189479485`*^9, 3.863184843649*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"e15c1f05-ee55-4a26-a7c8-57b601828953"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
    1}, $CellContext`p$$ = {0, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          (Dot[
           $CellContext`m2[#, #2], #3]& )[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8631883750991125`*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"24c4f5df-e323-4c9b-ba13-f173f98c9bb1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:52a0\:4e0a\:5e73\:79fb\
\>", "Subsection",
 CellChangeTimes->{{3.8631829362696257`*^9, 
  3.8631829517001705`*^9}},ExpressionUUID->"bc59a4d6-c1c6-4215-8202-\
da3d9d3ab5e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "-", "#"}], ")"}]}], "==", "0"}], 
     "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631837761332893`*^9, 3.8631839109235735`*^9}, {
  3.8631839822770915`*^9, 3.86318400006244*^9}, {3.8631841667934628`*^9, 
  3.8631842295949454`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"933666fc-29f8-4bfd-b1a1-2638fd62ebbb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "c"}], "-", 
        RowBox[{"a", " ", "b", " ", "d"}], "-", 
        RowBox[{"b", " ", "c", " ", "d"}], "+", 
        RowBox[{"a", " ", 
         SuperscriptBox["d", "2"]}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"2", " ", "a", " ", "c"}], "+", 
        SuperscriptBox["c", "2"], "-", 
        RowBox[{"2", " ", "b", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
        RowBox[{"b", " ", 
         SuperscriptBox["c", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "d"}], "-", 
        RowBox[{"a", " ", "c", " ", "d"}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"2", " ", "a", " ", "c"}], "+", 
        SuperscriptBox["c", "2"], "-", 
        RowBox[{"2", " ", "b", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8631883752140846`*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"14855f5c-0791-4f2c-9929-a4f96c8aabe7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "-", "a"}], ",", 
        RowBox[{"y", "-", "b"}]}], "}"}]}], "==", "0"}], "&&", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "-", "c"}], ",", 
        RowBox[{"y", "-", "d"}]}], "}"}]}], "==", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631837761332893`*^9, 3.8631839109235735`*^9}, {
  3.8631839822770915`*^9, 3.86318400006244*^9}, {3.8631840614389305`*^9, 
  3.8631841041078386`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"bf7b168d-a82e-4c29-b57a-d7f18a6dad99"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "c"}], "-", 
        RowBox[{"a", " ", "b", " ", "d"}], "-", 
        RowBox[{"b", " ", "c", " ", "d"}], "+", 
        RowBox[{"a", " ", 
         SuperscriptBox["d", "2"]}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"2", " ", "a", " ", "c"}], "+", 
        SuperscriptBox["c", "2"], "-", 
        RowBox[{"2", " ", "b", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
        RowBox[{"b", " ", 
         SuperscriptBox["c", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "d"}], "-", 
        RowBox[{"a", " ", "c", " ", "d"}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"2", " ", "a", " ", "c"}], "+", 
        SuperscriptBox["c", "2"], "-", 
        RowBox[{"2", " ", "b", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8631883752569723`*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"2122765b-2097-40f8-81cd-5d7540ac6707"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "/.", 
  RowBox[{"%", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8631850376124425`*^9, 3.8631850606626263`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"3413086c-7488-41ab-8b8c-858764a4601d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", "c"}], "-", 
     RowBox[{"a", " ", "b", " ", "d"}], "-", 
     RowBox[{"b", " ", "c", " ", "d"}], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox["d", "2"]}]}], 
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"2", " ", "a", " ", "c"}], "+", 
     SuperscriptBox["c", "2"], "-", 
     RowBox[{"2", " ", "b", " ", "d"}], "+", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
     RowBox[{"b", " ", 
      SuperscriptBox["c", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "d"}], "-", 
     RowBox[{"a", " ", "c", " ", "d"}]}], 
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"2", " ", "a", " ", "c"}], "+", 
     SuperscriptBox["c", "2"], "-", 
     RowBox[{"2", " ", "b", " ", "d"}], "+", 
     SuperscriptBox["d", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.8631883752995434`*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"6bcc7c44-53a1-4640-8059-e707e7ba1b1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"span", "[", 
   RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", "p1"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}], "=", "p2"}], ";", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "c"}], "-", 
         RowBox[{"a", " ", "b", " ", "d"}], "-", 
         RowBox[{"b", " ", "c", " ", "d"}], "+", 
         RowBox[{"a", " ", 
          SuperscriptBox["d", "2"]}]}], 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         RowBox[{"2", " ", "a", " ", "c"}], "+", 
         SuperscriptBox["c", "2"], "-", 
         RowBox[{"2", " ", "b", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
         RowBox[{"b", " ", 
          SuperscriptBox["c", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "d"}], "-", 
         RowBox[{"a", " ", "c", " ", "d"}]}], 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         RowBox[{"2", " ", "a", " ", "c"}], "+", 
         SuperscriptBox["c", "2"], "-", 
         RowBox[{"2", " ", "b", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"span", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8631851575919514`*^9, 3.8631852680753045`*^9}, {
  3.863185310287938*^9, 3.863185330429638*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"d0da0ffb-4a7d-4435-9858-4cd60f1dc7df"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.8631883753398275`*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"deb4785f-6915-4427-8695-876af1277dbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"span2", "[", 
   RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", "c"}], "-", 
       RowBox[{"a", " ", "b", " ", "d"}], "-", 
       RowBox[{"b", " ", "c", " ", "d"}], "+", 
       RowBox[{"a", " ", 
        SuperscriptBox["d", "2"]}]}], 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "-", 
       RowBox[{"2", " ", "a", " ", "c"}], "+", 
       SuperscriptBox["c", "2"], "-", 
       RowBox[{"2", " ", "b", " ", "d"}], "+", 
       SuperscriptBox["d", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
       RowBox[{"b", " ", 
        SuperscriptBox["c", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "d"}], "-", 
       RowBox[{"a", " ", "c", " ", "d"}]}], 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "-", 
       RowBox[{"2", " ", "a", " ", "c"}], "+", 
       SuperscriptBox["c", "2"], "-", 
       RowBox[{"2", " ", "b", " ", "d"}], "+", 
       SuperscriptBox["d", "2"]}]]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "->", 
      RowBox[{"p1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"b", "->", 
      RowBox[{"p1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"c", "->", 
      RowBox[{"p2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"d", "->", 
      RowBox[{"p2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"span2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8631851575919514`*^9, 3.8631852680753045`*^9}, {
  3.863185310287938*^9, 3.863185330429638*^9}, {3.863185366411953*^9, 
  3.863185517823266*^9}, {3.8631855603583274`*^9, 3.8631856088797054`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"afc3aa88-3a26-49dd-ad7e-a831ba8ccb88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.8631883753837457`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"f70e3370-cd31-471f-9d11-2903234348b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"visual", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"m1", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
    RowBox[{"2", 
     RowBox[{"span", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "]"}]], "Input",
 CellChangeTimes->{{3.8631857106895695`*^9, 3.8631857538871098`*^9}, 
   3.8631858108658705`*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"30cfc00b-4abe-439f-a677-73043f2be2ff"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
    1}, $CellContext`p$$ = {0, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          (Dot[
            $CellContext`m1[#, #2], #3] + 
          2 $CellContext`span[#, #2]& )[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8631883754346066`*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"cf0b7be3-65d4-452a-a760-97400bf3477e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"visual", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"m2", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
    RowBox[{"2", 
     RowBox[{"span", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "]"}]], "Input",
 CellChangeTimes->{{3.8631857106895695`*^9, 3.8631857538871098`*^9}, 
   3.863185801876442*^9},
 CellLabel->
  "In[203]:=",ExpressionUUID->"544630b2-9877-4078-b8db-05a7f64a5f18"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
    1}, $CellContext`p$$ = {0, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          (Dot[
            $CellContext`m2[#, #2], #3] + 
          2 $CellContext`span[#, #2]& )[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.863188375553603*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"89fc26ed-79ba-43ca-b72e-0ec4bf6451bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:6574\:7406\:6210\:4e00\:4e2a\:51fd\:6570", "Subsection",
 CellChangeTimes->{{3.863186184617589*^9, 
  3.8631861996171284`*^9}},ExpressionUUID->"d9cbc91e-454e-4e3b-be0a-\
ff3c1ff51e44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"m1", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
    RowBox[{"2", 
     RowBox[{"span", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631859533001437`*^9, 3.8631859695426455`*^9}, {
  3.863186034656086*^9, 3.863186116689061*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"7d06fe7b-1296-476b-955a-00bcb95fa758"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "c"}], "-", 
        RowBox[{"a", " ", "b", " ", "d"}], "-", 
        RowBox[{"b", " ", "c", " ", "d"}], "+", 
        RowBox[{"a", " ", 
         SuperscriptBox["d", "2"]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "-", 
      RowBox[{"2", " ", "a", " ", "c"}], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", " ", "b", " ", "d"}], "+", 
      SuperscriptBox["d", "2"]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "c"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "b"}], "+", "d"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]]}], ")"}], " ", "x"}], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "b"}], "+", "d"}], ")"}], " ", "y"}], 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["a", "2"]}], "-", 
      SuperscriptBox["b", "2"], "+", 
      RowBox[{"2", " ", "a", " ", "c"}], "-", 
      SuperscriptBox["c", "2"], "+", 
      RowBox[{"2", " ", "b", " ", "d"}], "-", 
      SuperscriptBox["d", "2"]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
        RowBox[{"b", " ", 
         SuperscriptBox["c", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "d"}], "-", 
        RowBox[{"a", " ", "c", " ", "d"}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "-", 
      RowBox[{"2", " ", "a", " ", "c"}], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", " ", "b", " ", "d"}], "+", 
      SuperscriptBox["d", "2"]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "d"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "b"}], "+", "d"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]]}], ")"}], " ", "x"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "b"}], "+", "d"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "-", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "c"}], "-", 
         SuperscriptBox["c", "2"], "+", 
         RowBox[{"2", " ", "b", " ", "d"}], "-", 
         SuperscriptBox["d", "2"]}]]}], ")"}], " ", "y"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8631883756722755`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"57b575c1-fffa-467f-adcc-7b7757487550"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
     RowBox[{"2", 
      RowBox[{"span", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8631862107319927`*^9, 3.8631862630031147`*^9}, 
   3.863186322372897*^9, {3.863186525525208*^9, 3.863186548487262*^9}, {
   3.8631866407429204`*^9, 3.8631866456051283`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"e46d04f4-b54e-4615-aef4-64e6ec17f7e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "b", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{"a", "+", "c", "-", "x"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "c"}], "-", "x"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", "x"}], "-", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", "x"}], "+", 
     RowBox[{"2", " ", "b", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], " ", "y"}], "+", 
     RowBox[{"2", " ", "c", " ", "d", " ", "y"}], "+", 
     RowBox[{"2", " ", "a", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "-", 
        RowBox[{"c", " ", "x"}], "-", 
        RowBox[{"d", " ", "y"}]}], ")"}]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"b", "-", "d"}], ")"}], "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "x"}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c"}], "+", "x"}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", "b", "-", "c", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b", "-", "c", "+", "d"}], ")"}], " ", "y"}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"b", "-", "d"}], ")"}], "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.863188375960245*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"dea42f43-987b-420b-9bdc-c387ce82960d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"symmetry", "[", 
   RowBox[{"pa_", ",", "pb_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "x", ",", "y"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", "pa"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}], "=", "pb"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", "p"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "b", " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "-", "x"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "c"}], "-", "x"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "x"}], "+", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", "x"}], "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "x"}], "+", 
          RowBox[{"2", " ", "b", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}], " ", "y"}], "+", 
          RowBox[{"2", " ", "c", " ", "d", " ", "y"}], "+", 
          RowBox[{"2", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "-", 
             RowBox[{"c", " ", "x"}], "-", 
             RowBox[{"d", " ", "y"}]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"b", "-", "d"}], ")"}], "2"]}], ")"}]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"a", "-", "x"}], ")"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "c"}], "+", "x"}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", "c", "-", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "b", "-", "c", "+", "d"}], ")"}], " ", "y"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"b", "-", "d"}], ")"}], "2"]}]]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"visual", "[", "symmetry", "]"}]}], "Input",
 CellChangeTimes->{{3.8631862107319927`*^9, 3.8631862630031147`*^9}, {
   3.863186322372897*^9, 3.8631863376393957`*^9}, {3.8631864334604034`*^9, 
   3.863186498430374*^9}, {3.8631865680216613`*^9, 3.8631865723806424`*^9}, {
   3.8631866163568716`*^9, 3.8631866259221745`*^9}, {3.863186671993576*^9, 
   3.8631867502598033`*^9}, {3.863186815392179*^9, 3.8631868467401047`*^9}, 
   3.863186887628729*^9, {3.8631869815490513`*^9, 3.863186990888975*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"93aebfcb-4c63-419f-a364-c62b699564e5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
    1}, $CellContext`p$$ = {0, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          $CellContext`symmetry[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.863188375997614*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"a098a3fe-2259-4244-a4ef-d4a74cbceac5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8631869727676973`*^9, 3.863186979103185*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"968617d0-ce34-4e0d-921c-a071329d09ad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"m2", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
    RowBox[{"2", 
     RowBox[{"span", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631859533001437`*^9, 3.8631859695426455`*^9}, {
  3.863186034656086*^9, 3.8631861449550257`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"861c14e2-2ab5-4682-8fd7-8bc0abcb3274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "c"}], "-", 
        RowBox[{"a", " ", "b", " ", "d"}], "-", 
        RowBox[{"b", " ", "c", " ", "d"}], "+", 
        RowBox[{"a", " ", 
         SuperscriptBox["d", "2"]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "-", 
      RowBox[{"2", " ", "a", " ", "c"}], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", " ", "b", " ", "d"}], "+", 
      SuperscriptBox["d", "2"]}]], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "b", " ", "c"}], "+", 
        RowBox[{"b", " ", 
         SuperscriptBox["c", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "d"}], "-", 
        RowBox[{"a", " ", "c", " ", "d"}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "-", 
      RowBox[{"2", " ", "a", " ", "c"}], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", " ", "b", " ", "d"}], "+", 
      SuperscriptBox["d", "2"]}]], "-", 
    RowBox[{"y", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8631883761177816`*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"faeed94a-d019-4d68-8e9c-812800a04f73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], ".", "#3"}], "+", 
     RowBox[{"2", 
      RowBox[{"span", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}]}]}], "&"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8631859533001437`*^9, 3.8631859695426455`*^9}, {
  3.863186034656086*^9, 3.8631861449550257`*^9}, {3.863187056288478*^9, 
  3.8631870620574837`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"aea88717-f87c-4b26-8803-89c4824a106f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"b", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "c"}], "-", 
        RowBox[{"a", " ", "d"}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"b", "-", "d"}], ")"}], "2"]}]], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "c"}], "+", 
        RowBox[{"a", " ", "d"}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"b", "-", "d"}], ")"}], "2"]}]], "-", 
    RowBox[{"y", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{
          RowBox[{"a", "-", "c"}], ",", 
          RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863188377627516*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"1cb2993b-69bf-41b5-98cf-66da4d01feb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"symmetry2", "[", 
   RowBox[{"pa_", ",", "pb_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "x", ",", "y"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", "pa"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}], "=", "pb"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", "p"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"b", "-", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", "c"}], "-", 
            RowBox[{"a", " ", "d"}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"b", "-", "d"}], ")"}], "2"]}]], "+", 
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"Complex", "[", 
             RowBox[{
              RowBox[{"a", "-", "c"}], ",", 
              RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
        RowBox[{"y", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"Complex", "[", 
             RowBox[{
              RowBox[{"a", "-", "c"}], ",", 
              RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", "c"}], "+", 
            RowBox[{"a", " ", "d"}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"b", "-", "d"}], ")"}], "2"]}]], "-", 
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"Complex", "[", 
             RowBox[{
              RowBox[{"a", "-", "c"}], ",", 
              RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}], "+", 
        RowBox[{"x", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"Complex", "[", 
             RowBox[{
              RowBox[{"a", "-", "c"}], ",", 
              RowBox[{"b", "-", "d"}]}], "]"}], "]"}]}], "]"}]}]}]}], 
      "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"visual", "[", "symmetry", "]"}]}], "Input",
 CellChangeTimes->{{3.8631871456022773`*^9, 3.863187155863758*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"a3130c1c-0d60-4c84-9f15-bedb60353605"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = {2.83, 
    3.620000000000001}, $CellContext`b$$ = {2.2199999999999998`, 
    1.8200000000000003`}, $CellContext`p$$ = {0.6600000000000001, 2.92}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0, 1}}, Automatic}, {{
       Hold[$CellContext`a$$], {0, 0}}, Automatic}, {{
       Hold[$CellContext`b$$], {1, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = {0, 0}, $CellContext`b$$ = {1, 
         1}, $CellContext`p$$ = {0, 1}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{Thick, Orange, 
         InfiniteLine[{$CellContext`a$$, $CellContext`b$$}], 
         PointSize[Large], Magenta, 
         Point[$CellContext`p$$], 
         Point[
          $CellContext`symmetry[$CellContext`a$$, $CellContext`b$$, \
$CellContext`p$$]], Green, 
         Arrow[
          Map[{{0, 0}, #}& , 
           $CellContext`base[$CellContext`a$$, $CellContext`b$$]]]}, Axes -> 
        True, PlotRange -> 5], 
      "Specifications" :> {{{$CellContext`p$$, {0, 1}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`a$$, {0, 0}}, Automatic, 
         ControlType -> Locator}, {{$CellContext`b$$, {1, 1}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{416., {212.13403309800196`, 217.86596690199804`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.863188377686948*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"4a62b62d-15a1-4e69-9d2c-c50ccadd8ef8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{762., 624.75},
WindowMargins->{{Automatic, 115.5}, {-11.25, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2022\:5e742\:67084\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"750391b8-3502-4204-8168-78206c2409ca"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 237, 4, 98, "Title",ExpressionUUID->"85787228-ba18-4809-89b6-1537c128d482"],
Cell[820, 28, 254, 4, 35, "Text",ExpressionUUID->"81533e1f-1d57-4766-af9a-44e52ca3e7ea"],
Cell[CellGroupData[{
Cell[1099, 36, 411, 8, 81, "Subsection",ExpressionUUID->"fa9da9e5-62c8-4133-a9e7-d3530ad9293d"],
Cell[CellGroupData[{
Cell[1535, 48, 4228, 107, 295, "Input",ExpressionUUID->"ed57bc89-60e9-4ec5-abe1-d5884267ec20"],
Cell[5766, 157, 2470, 50, 449, "Output",ExpressionUUID->"8551480b-183c-4f32-bb95-228083e94df9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8285, 213, 342, 7, 81, "Subsection",ExpressionUUID->"412f91e9-d930-47bf-bb92-9decc7222254"],
Cell[CellGroupData[{
Cell[8652, 224, 1574, 41, 64, "Input",ExpressionUUID->"e15c1f05-ee55-4a26-a7c8-57b601828953"],
Cell[10229, 267, 2470, 50, 449, "Output",ExpressionUUID->"24c4f5df-e323-4c9b-ba13-f173f98c9bb1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12748, 323, 184, 5, 54, "Subsection",ExpressionUUID->"bc59a4d6-c1c6-4215-8202-da3d9d3ab5e9"],
Cell[CellGroupData[{
Cell[12957, 332, 827, 26, 43, "Input",ExpressionUUID->"933666fc-29f8-4bfd-b1a1-2638fd62ebbb"],
Cell[13787, 360, 1525, 44, 51, "Output",ExpressionUUID->"14855f5c-0791-4f2c-9929-a4f96c8aabe7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15349, 409, 851, 26, 43, "Input",ExpressionUUID->"bf7b168d-a82e-4c29-b57a-d7f18a6dad99"],
Cell[16203, 437, 1525, 44, 51, "Output",ExpressionUUID->"2122765b-2097-40f8-81cd-5d7540ac6707"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17765, 486, 302, 8, 28, "Input",ExpressionUUID->"3413086c-7488-41ab-8b8c-858764a4601d"],
Cell[18070, 496, 1206, 36, 51, "Output",ExpressionUUID->"6bcc7c44-53a1-4640-8059-e707e7ba1b1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19313, 537, 2005, 58, 134, "Input",ExpressionUUID->"d0da0ffb-4a7d-4435-9858-4cd60f1dc7df"],
Cell[21321, 597, 244, 7, 48, "Output",ExpressionUUID->"deb4785f-6915-4427-8695-876af1277dbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21602, 609, 2155, 62, 89, "Input",ExpressionUUID->"afc3aa88-3a26-49dd-ad7e-a831ba8ccb88"],
Cell[23760, 673, 244, 7, 48, "Output",ExpressionUUID->"f70e3370-cd31-471f-9d11-2903234348b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24041, 685, 452, 13, 28, "Input",ExpressionUUID->"30cfc00b-4abe-439f-a677-73043f2be2ff"],
Cell[24496, 700, 2511, 51, 449, "Output",ExpressionUUID->"cf0b7be3-65d4-452a-a760-97400bf3477e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27044, 756, 450, 13, 28, "Input",ExpressionUUID->"544630b2-9877-4078-b8db-05a7f64a5f18"],
Cell[27497, 771, 2509, 51, 449, "Output",ExpressionUUID->"89fc26ed-79ba-43ca-b72e-0ec4bf6451bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30055, 828, 192, 3, 54, "Subsection",ExpressionUUID->"d9cbc91e-454e-4e3b-be0a-ff3c1ff51e44"],
Cell[CellGroupData[{
Cell[30272, 835, 648, 20, 28, "Input",ExpressionUUID->"7d06fe7b-1296-476b-955a-00bcb95fa758"],
Cell[30923, 857, 5027, 152, 183, "Output",ExpressionUUID->"57b575c1-fffa-467f-adcc-7b7757487550"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35987, 1014, 775, 22, 43, "Input",ExpressionUUID->"e46d04f4-b54e-4615-aef4-64e6ec17f7e1"],
Cell[36765, 1038, 2038, 65, 97, "Output",ExpressionUUID->"dea42f43-987b-420b-9bdc-c387ce82960d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38840, 1108, 3400, 92, 181, "Input",ExpressionUUID->"93aebfcb-4c63-419f-a364-c62b699564e5"],
Cell[42243, 1202, 2442, 49, 449, "Output",ExpressionUUID->"a098a3fe-2259-4244-a4ef-d4a74cbceac5"]
}, Open  ]],
Cell[44700, 1254, 177, 3, 28, "Input",ExpressionUUID->"968617d0-ce34-4e0d-921c-a071329d09ad"],
Cell[CellGroupData[{
Cell[44902, 1261, 650, 20, 28, "Input",ExpressionUUID->"861c14e2-2ab5-4682-8fd7-8bc0abcb3274"],
Cell[45555, 1283, 2452, 75, 125, "Output",ExpressionUUID->"faeed94a-d019-4d68-8e9c-812800a04f73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48044, 1363, 751, 22, 43, "Input",ExpressionUUID->"aea88717-f87c-4b26-8803-89c4824a106f"],
Cell[48798, 1387, 2148, 71, 93, "Output",ExpressionUUID->"1cb2993b-69bf-41b5-98cf-66da4d01feb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50983, 1463, 3054, 90, 307, "Input",ExpressionUUID->"a3130c1c-0d60-4c84-9f15-bedb60353605"],
Cell[54040, 1555, 2522, 50, 472, "Output",ExpressionUUID->"4a62b62d-15a1-4e69-9d2c-c50ccadd8ef8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

